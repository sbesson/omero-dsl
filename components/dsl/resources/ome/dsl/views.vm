--
-- Copyright 2008 Glencoe Software, Inc. All rights reserved.
-- Use is subject to license terms supplied in LICENSE.txt
--

-- This file was generated by dsl/resources/ome/dsl/views.vm
-- and can be used to overwrite the generated Map<Long, Long> tables
-- with functional views.

BEGIN;

#foreach($type in $types)
#foreach($prop in $type.classProperties)
#if($prop.one2Many && $prop.isLink)
  DROP TABLE count_${type.shortname}_${prop.name}_by_owner;

  CREATE OR REPLACE VIEW count_${type.shortname}_${prop.name}_by_owner (${type.shortname}_id, owner_id, count) AS select ${prop.inverse}, owner_id, count(*)
    FROM ${prop.shortType} GROUP BY ${prop.inverse}, owner_id ORDER BY ${prop.inverse};

#end
#end
#end

COMMIT;
